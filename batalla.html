<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DOMUS MAGI: BATALLA V83</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js"></script>
</head>
<body>
    <div id="container-ar"></div>
    <div id="ui-superior-fijo" style="position:fixed; top:10px; left:10px; z-index:9000; display:none;">
        <div id="txt-turno" style="background:rgba(0,0,0,0.9); padding:10px 15px; border:3px solid gold; font-size:24px; font-weight:900; border-radius:8px;">TURNO: ---</div>
        <div id="txt-vuelta" style="background:gold; color:black; padding:5px 10px; font-weight:900; border-radius:5px; margin-top:5px; display:inline-block;">VUELTA: 1 / 7</div>
    </div>
    <div id="modal-dados-fase" class="pantalla oculto" style="z-index:9500; background:rgba(0,0,0,0.9);">
        <h1 id="dados-player-name" style="font-size:36px; font-weight:900; color:white;">JUGADOR</h1>
        <div class="dados-container">
            <video id="video-dados-batalla" class="video-dados" src="https://kairosravina-bot.github.io/domusmagis/Dados.mp4" playsinline muted></video>
            <div id="layer-valor-batalla" class="layer-valor" style="font-weight:900;">0</div>
        </div>
        <div class="grid-dados">
            <div class="btn-dado-sel" onclick="window.ejecutarLanzamientoBatalla(2)"><strong>2</strong></div>
            <div class="btn-dado-sel" onclick="window.ejecutarLanzamientoBatalla(3)"><strong>3</strong></div>
            <div class="btn-dado-sel" onclick="window.ejecutarLanzamientoBatalla(4)"><strong>4</strong></div>
            <div class="btn-dado-sel" onclick="window.ejecutarLanzamientoBatalla(5)"><strong>5</strong></div>
        </div>
    </div>
    <div id="modal-batalla" class="pantalla oculto" style="z-index:9999; background:rgba(0,0,0,0.95);">
        <h2 style="color:gold; font-weight:900;">BATALLA FINAL</h2>
        <video id="video-clash" playsinline webkit-playsinline muted controls style="width:100%; max-height:60vh; border-top:4px solid gold; border-bottom:4px solid gold; background:black;"></video>
    </div>
    <div id="p-setup" class="pantalla" style="background:rgba(0,0,0,0.8);">
        <h2>INSCRIPCI√ìN</h2>
        <div id="setup-selector" style="display:flex; gap:10px;">
            <button class="btn-master" onclick="window.setModo(2)">2 MAGOS</button>
            <button class="btn-master" onclick="window.setModo(4)">4 MAGOS</button>
        </div>
        <div id="registro" class="oculto">
            <input type="text" id="mago-nombre" placeholder="NOMBRE DEL MAGO">
            <div class="grid-casas">
                <button onclick="window.registrarMago('TERRA','#ff0000')" class="btn-casa" style="background:#500;">üõ°Ô∏è TERRA</button>
                <button onclick="window.registrarMago('CAELUM','#00aaff')" class="btn-casa" style="background:#003;">‚öîÔ∏è CAELUM</button>
                <button onclick="window.registrarMago('AQUA','#00ff88')" class="btn-casa" style="background:#030;">üíß AQUA</button>
                <button onclick="window.registrarMago('DIMENSIO','#aa00ff')" class="btn-casa" style="background:#303;">‚ú® DIMENSIO</button>
            </div>
        </div>
    </div>
    <div id="ui-juego" class="oculto">
        <div id="zona-superior">
            <div id="hud-derecho">
                <img id="hud-img-escudo" src="">
                <div id="hud-txt-arma" style="font-weight:900; color:white;">ARMA</div>
                <div id="hud-txt-valor" style="font-weight:900; font-size:60px; color:gold;">00</div>
            </div>
            <div id="guia-scanner"></div>
            <video id="video-action" playsinline style="display:none;"></video>
        </div>
        <div id="zona-inferior">
            <div id="msg-visor" style="font-size:26px; color:gold; font-weight:900;">ESCANEA CARTA</div>
            <p style="color:#aaa; font-weight:900;">SLOT: <span id="slot-indicator">1/3</span></p>
            <div class="contenedor-gemas">
                <div class="wrapper-gema"><span id="val-i" class="valor-flotante"></span><button id="btn-i" class="btn-gema"><span class="letra-grande">I</span></button></div>
                <div class="wrapper-gema"><span id="val-a" class="valor-flotante"></span><button id="btn-a" class="btn-gema"><span class="letra-grande">A</span></button></div>
                <div class="wrapper-gema"><span id="val-t" class="valor-flotante"></span><button id="btn-t" class="btn-gema"><span class="letra-grande">T</span></button></div>
                <div class="wrapper-gema"><span id="val-m" class="valor-flotante"></span><button id="btn-m" class="btn-gema"><span class="letra-grande">M</span></button></div>
            </div>
            <div style="display:flex; gap:10px; width:100%;">
                <button id="btn-confirmar" class="btn-master" style="background:#050; flex:2;">‚úÖ CONFIRMAR</button>
                <button id="btn-forzar" class="btn-master" style="background:#500; flex:1;" onclick="window.iniciarFaseFinal()">‚öîÔ∏è YA</button>
                <button id="btn-reescaneo" class="btn-master" style="background:#aa8800; flex:1;" onclick="window.forzarReescaneo()">üîÑ RESCAN</button>
            </div>
        </div>
    </div>
    <div id="p-resultado" class="pantalla oculto">
        <div id="resultado-batalla">
            <div id="resultado-contenido"></div>
        </div>
        <button id="btn-repetir-accion" class="btn-master" onclick="window.continuarContienda()">‚öîÔ∏è SIG. VUELTA</button>
    </div>
    <script type="module">
        // L√≥gica de batalla.html (Importada de ojo.js)
    </script>
</body>
</html>